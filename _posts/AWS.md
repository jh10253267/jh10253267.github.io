# AWS

## 개요

## 클라우드란?

클라우드란 온프레미스와 반대되는 개념으로 우리가 사용하는 전기, 수도, 아파트를 생각하면 쉽다.

우리는 직접 전기를 만들어서 사용하지 않고 수도, 아파트 관리 등도 마찬가지다. 아파트에선 승강기, 단지 내 시설등을 제공하고 우리는 그 비용을 지불한다.  
이런 것을 클라우드 서비스라고 한다.  
규모의 경제라고 생각해도 무방하다.

온프레미스는 직접 집을 설계하고 배관과 같은 시스템을 직접 알아보고 의뢰해야하는 상황과 비슷하다.  
많은 시간과 노력이 필요하다.
작은 서비스를 제공하는데도 직접 물리적 서버를 구축하고 관리한다. 이렇게 되면 사용자가 많든 적든 일정 비용을 지불해야한다.  
이것이 온프레미스의 단점이다.

클라우드는 구축하려는 서비스에 필요한 리소스를 사용하고 사용한 양만큼 비용을 지불하는 구조다.

여러가지 클라우드 컴퓨팅 서비스가 있지만 그 중 대표적인 것이 바로 AWS다.

## 사용방법

1. AWS 계정을 생성하고 서비스를 배포할 리전을 정한다.
리전은 AWS가 데이터 센터를 클러스터링하는 물리적 위치를 의미한다. 네트워크는 마법이 아니기에 서버까지의 거리에 따라 지연시간이 생긴다. 따라서 사용자가 요청을 보내는 지역과 가장 가까운 지역을 사용하는 것이 유리하다.
2. 사용할 서비스에서 인스턴스를 생성한다.
이렇게 요약할 수 있겠다.

자세한 내용은 각각의 서비스 파트에서 정리하려고 한다.

## AWS 핵심 서비스

AWS에서 제공하는 서비스는 크게 보안, 네트워킹, 서버, 스토리지 및 데이터베이스로 구성된다.

예를 들어 방화벽, ACL, 관리자의 기능은 각각 보안그룹 네트워크 ACL, AWS IAM으로,  
네트워킹의 라우터, 네트워크 파이프라인, 스위치는 AWS의 Elastic Load Balancing, Amazon VPC로,
온프레미스 서버는 EC2 인스턴스로,
스토리지 및 데이터베이스는 Amazon EBS, EFS, S3, RDS로 제공된다.

## EC2

EC2는 Amazon Elastic Compute Cloud로 하나의 가상 컴퓨터를 제공하는 서비스다. EC2를 사용해서 웹 서버, 애플리케이션 서버, 데이터베이스 서버를 구축할 수 있다. 그 외에 인프라 오케스트레이션 서비스를 통해 EC2인스턴스를 만들고 사용할 수 있다.

EC2는 AMI(Amazon Machine Images)라고 하는 이미지를 기반으로 구성할 수 있다.
AMI는 스토리지 볼륨, 시작 권한 등의 정보가 담겨있다.  
AWS에서는 Marketplace를 통해 AMI를 목적에 맞게 선택해서 사용할 수 있다.

예를 들어 소규모 웹사이트를 운영한다면 A1, T3, M6g와 같은 인스턴스를 구입해서 사용할 수 있고 EC2에서 데이터베이스 서버를 구동시키고 싶다면 스토리지에 최적화된 D2, H1등을 사용할 수 있다.

EC2의 요금 종류에는 4가지가 있다.
* 온 디멘드 인스턴스 : 중단할 수 없는 불규칙한 단기 워크로드가 있는 애플리케이션으로 초당 요금이 부과된다.
* 예약형 인스턴스 : 특정 기간동안 특정 가격으로 인스턴스를 이용하겠다는 약정
* Savings Plans: 정해진 기간 동안 시간당 일정한 금액을 지출하겠다는 약정
* 스팟 인스턴스 : 여분의 EC2호스트 용량을 사용하는 인스턴스로 온디멘드 인스턴스 요금 대비 최대 90%까지 절약할 수 있다.

만약 연중무휴 24시간 가동되어야하는 서버가 있는데 요청을 많이 처리하지 않아 온디멘드 인스턴스를 사용하면 사용이 많이 않아도 요금을 계속 내야한다. 이럴 경우 서버리스 컴퓨팅 서비스를 사용해볼 수 있따.

서버리스 컴퓨팅은 서버를 관리하지 않고 애플리케이션과 서비스를 구출하고 실행하는 것을 말하며 AWS에서는 AWS Lambda서비스를 통해 제공된다.

코드를 보내면 컨테이너에 배포된다. 그러나 컨테이너 자체는 AWS에서 만들고 배포하고 관리한다. 사용자는 관리에 관여할 필요가 없고 애초에 리소스에 접근할 수 없다. 

예를 들어 사용자가 스토리지에 업로드한다고 하면 S3가 Lambda를 트리거하고 Lambda는 다른 서비스를 통해 이미지 인식을 수행하고 그 결과를 텍스트 파일로 변환시켜 S3에 저장한다. 이를 Event Driven Architecture라고 부른다.

## Storage

대표적인 서비스는 S3로, 다양한 형식의 데이터를 객체로 원하는 만큼 저장하고 검색할 수 있는 스토리지다.  

객체에는 파일이나 이미지등이 해당되고 별도로 따로 폴더를 생성할 수 없고 모든 객체들은 수평적으로 저장되고 관리된다.

S3는 뛰어난 데이터 내구성을 제공하도록 설계되었다고 한다. 천만개의 데이터가 저장되어있을 때 1만 년 동안 객체 1개가 손실되는 확률의 내구성을 가진다.

## Database

AWS에서는 두 가지 방법으로 데이터베이스를 사용할 수 있다. EC2에서 상용 데이터베이스를 띄워 사용하거나 AWS에서 관리하는 데이터베이스 서비스를 이용하는 방법이다.

